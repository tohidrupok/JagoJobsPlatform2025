{% extends 'employer.html' %}
{% load static %}

{% block body %}
        <!-- Page Content Holder -->
        <div id="content">

            <div class="content-admin-main">

            	<div class="wt-admin-right-page-header clearfix">
                    <h2>Company Profile!</h2>
                    <div class="breadcrumbs"><a href="{% url 'home' %}">Home</a><a href="{% url 'employer_dashboard' %}">Dasboard</a><span>Company Profile!</span></div>
                </div>

                <!--Logo and Cover image-->
                <div class="panel panel-default">
                    <div class="panel-heading wt-panel-heading p-a20">
                        <h4 class="panel-tittle m-a0">Logo and Cover image</h4>
                    </div>
                    <div class="panel-body wt-panel-body p-a20 p-b0 m-b30 ">
                        
                        <div class="row">
                                
                            <div class="col-lg-12 col-md-12">
                                <div class="form-group">
                                    
                                    <div class="dashboard-profile-pic">
                                        <div class="dashboard-profile-photo">
                                            <img src="{{ profile.logo.url }}" alt=""> 
                                            <div class="upload-btn-wrapper">
                                                <div id="upload-image-grid"></div>
                                                <button class="site-button button-sm">Upload Photo</button>
                                                <input type="file" name="myfile" id="file-uploader" accept=".jpg, .jpeg, .png">
                                            </div>
                                        </div>
                                        <p><b>Company Logo :- </b> Max file size is 1MB, Minimum dimension: 136 x 136 And Suitable files are .jpg & .png</p>
                                    </div> 

                                    
                                    
                                    <script>
                                        document.getElementById("file-uploader").addEventListener("change", function(event) {
                                            var file = event.target.files[0];
                                            if (file) {
                                                var reader = new FileReader();
                                                reader.onload = function(){
                                                    document.getElementById("logo-preview").src = reader.result;
                                                };
                                                reader.readAsDataURL(file);
                                        
                                                // Upload the file automatically using AJAX
                                                var formData = new FormData();
                                                formData.append("logo", file);
                                                formData.append("csrfmiddlewaretoken", "{{ csrf_token }}"); // CSRF token
                                        
                                                fetch("{% url 'employer_profile_edit' %}", {  // Using the same view
                                                    method: "POST",
                                                    body: formData
                                                })
                                                .then(response => response.json())
                                                .then(data => {
                                                    if (data.success) {
                                                        document.getElementById("logo-preview").src = data.logo_url;  // Update preview
                                                    } else {
                                                        alert("Failed to upload logo. Please try again.");
                                                    }
                                                })
                                                .catch(error => console.error("Error uploading logo:", error));
                                            }
                                        });
                                    </script>

                                </div> 
                            </div>

                            {% comment %} <div class="col-lg-12 col-md-12">
                                <div class="dashboard-cover-pic">
                                    <form action="upload.php" class="dropzone"></form>
                                    <p><b>Background Banner Image :- </b> Max file size is 1MB, Minimum dimension: 770 x 310 And Suitable files are .jpg & .png</p> 
                                </div>                                    
                            </div> {% endcomment %}

                        </div>
                                    
                    </div>
                </div> 

                {% load static %}
                <form method="POST" action="" enctype="multipart/form-data">
                    {% csrf_token %}
                    
                    <div class="panel panel-default mb-4">
                        <div class="panel-heading wt-panel-heading p-3 bg-primary text-white rounded-top">
                            <h4 class="panel-title m-0">Company Profile</h4>
                        </div>
                        <div class="panel-body wt-panel-body p-4 bg-white rounded-bottom">
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label class="fw-bold">Company Name</label>
                                        <div class="input-group">
                                            <span class="input-group-text"><i class="fa fa-building"></i></span>
                                            {{ form.company_name }}
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label class="fw-bold">Phone</label>
                                        <div class="input-group">
                                            <span class="input-group-text"><i class="fa fa-phone-alt"></i></span>
                                            {{ form.phone }}
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label class="fw-bold">Email Address</label>
                                        <div class="input-group">
                                            <span class="input-group-text"><i class="fas fa-at"></i></span>
                                            {{ form.email }}
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label class="fw-bold">Location</label>
                                        <div class="input-group">
                                            <span class="input-group-text"><i class="fa fa-globe"></i></span>
                                            {{ form.location }}
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label class="fw-bold">Founding Date</label>
                                        <div class="input-group">
                                            <span class="input-group-text"><i class="fa fa-globe"></i></span>
                                            {{ form.founded_date }}
                                        </div>
                                    </div>
                                </div>
                                <div class="col-12">
                                    <div class="form-group">
                                        <label class="fw-bold">Description</label>
                                        {{ form.company_description }}
                                    </div>
                                </div>
                
                                <!-- Logo Upload Section -->
                                {% comment %} <div class="col-md-6">
                                    <div class="form-group">
                                        <label class="fw-bold">Company Logo</label>
                                        <div class="input-group">
                                            <span class="input-group-text"><i class="fa fa-image"></i></span>
                                            {{ form.logo }}
                                        </div>
                                    </div>
                                </div> {% endcomment %}
                
                                <div class="col-12 text-end">
                                    <button type="submit" class="btn btn-primary">Save Changes</button>
                                </div>
                            </div>
                        </div>
                    </div>
                
                    <div class="panel panel-default">
                        <div class="panel-heading wt-panel-heading p-3 bg-primary text-white rounded-top">
                            <h4 class="panel-title m-0">Social Network</h4>
                        </div>
                        <div class="panel-body wt-panel-body p-4 bg-white rounded-bottom">
                            <div class="row g-3">
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="fw-bold">Website</label>
                                        <div class="input-group">
                                            <span class="input-group-text"><i class="fa fa-globe"></i></span>
                                            {{ form.company_website }}
                                        </div>
                                    </div>
                                </div> 

                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="fw-bold">Facebook</label>
                                        <div class="input-group">
                                            <span class="input-group-text"><i class="fab fa-facebook-f"></i></span>
                                            {{ form.facebook_link }}
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="fw-bold">Twitter</label>
                                        <div class="input-group">
                                            <span class="input-group-text"><i class="fab fa-twitter"></i></span>
                                            {{ form.twitter_link }}
                                        </div>
                                    </div>
                                </div> 
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="fw-bold">Youtube Video</label>
                                        <div class="input-group">
                                            <span class="input-group-text"><i class="fab fa-linkedin-in"></i></span>
                                            {{ form.google_link }}
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="fw-bold">LinkedIn</label>
                                        <div class="input-group">
                                            <span class="input-group-text"><i class="fab fa-linkedin-in"></i></span>
                                            {{ form.linkedin_link }}
                                        </div>
                                    </div>
                                </div>
                                <div class="col-12 text-end">
                                    <button type="submit" class="btn btn-primary">Save Changes</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
 



                                                     
            </div>

    	</div>

{% endblock %} 

